---
# [ Service Identity ]
restic_service_name: "restic"
restic_container_name: "{{ restic_service_name }}"
restic_image: "local/restic-with-rclone"
restic_base_image: "restic/restic"
# Обновляем версию (последняя стабильная на момент написания)
restic_base_version: "0.17.0"

# [ Paths & Directories ]
restic_compose_dir: "{{ docker_base_dir }}/{{ restic_service_name }}"
restic_config_dir: "{{ restic_compose_dir }}/config"
restic_build_dir: "{{ restic_compose_dir }}/build"

# [ Schedule ]
restic_timer_schedule: "*-*-* 04:00:00"
restic_check_schedule: "Sun *-*-* 06:00:00"

# [ Check Settings ]
restic_check_subset: "5%"

# [ Secrets ]
# Внимание: Эти переменные ожидаются из Vault
restic_password: "{{ vault_backup.restic_password }}"
restic_rclone_config: "{{ vault_backup.rclone_config }}"

# [ Repository ]
restic_repo: "rclone:gdrive:vps_backups"
restic_healthcheck_url: ""

# [ Rclone Tuning ]
restic_rclone_chunk_size: "128M"
restic_rclone_timeout: "10m"

# [ Retention Policy ]
restic_keep_daily: 7
restic_keep_weekly: 4

# [ Service to Stop ]
# Какой сервис нужно остановить перед бекапом (чтобы БД была консистентна)?
# Оставляем пустым, если не нужно, или указываем "tuwunel" (Matrix)
restic_stop_service: ""

# [ Resources ]
restic_memory_limit: "{{ docker_memory_limit | default('512M') }}"

# [ Backup Paths ]
restic_mounts:
  - src: "{{ docker_base_dir }}"
    dst: "/data"
